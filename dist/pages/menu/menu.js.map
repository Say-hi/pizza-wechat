{"version":3,"sources":["pages/menu/menu.js"],"names":["app","getApp","Page","data","currentIndex","sizeIndex","sizeNum","allMoney","couponArr","need","del","id","menuArr","img","name","sale","price","sizeArr","size","num","src","getCoupon","e","that","setToast","image","bgc","color","content","chooseMenuNum","currentTarget","dataset","type","index","setData","setGoodsStorage","confirm","wx","navigateTo","url","close","showIndex","showSizeChoose","goodsStorage","gs","length","push","entries","i","v","m","splice","su","calculatorMoney","allCount","removeStorageSync","chooseSize","chooseSizeNum","chooseTab","onLoad","onReady","onShow","parseInt","g","s","onHide","onUnload","onPullDownRefresh"],"mappings":"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","file":"menu.js","sourcesContent":["// 获取全局应用程序实例对象\nconst app = getApp()\n\n// 创建页面实例对象\nPage({\n  /**\n   * 页面的初始数据\n   */\n  data: {\n    currentIndex: 0,\n    sizeIndex: 0,\n    sizeNum: 1,\n    allMoney: 0,\n    couponArr: [\n      {\n        need: 100,\n        del: 10,\n        id: 12\n      },\n      {\n        need: 100,\n        del: 10,\n        id: 12\n      }\n    ],\n    menuArr: [\n      {\n        img: 'http://img02.tooopen.com/images/20150928/tooopen_sy_143912755726.jpg',\n        name: '超级好吃的榴莲',\n        sale: '888',\n        price: '88.50',\n        id: 1,\n        sizeArr: []\n      },\n      {\n        img: 'http://img02.tooopen.com/images/20150928/tooopen_sy_143912755726.jpg',\n        name: '超级好吃的榴莲',\n        sale: '888',\n        price: '88.50',\n        id: 2,\n        sizeArr: []\n      },\n      {\n        img: 'http://img02.tooopen.com/images/20150928/tooopen_sy_143912755726.jpg',\n        name: '超级好吃的榴莲',\n        sale: '888',\n        price: '88.50',\n        id: 3,\n        sizeArr: [\n          {\n            id: 31,\n            size: 10,\n            price: 110,\n            num: 1\n          },\n          {\n            id: 32,\n            size: 40,\n            price: 13,\n            num: 1\n          }\n        ]\n      },\n      {\n        img: 'http://img02.tooopen.com/images/20150928/tooopen_sy_143912755726.jpg',\n        name: '超级好吃的榴莲',\n        sale: '888',\n        price: '88.50',\n        id: 4,\n        sizeArr: [\n          {\n            id: 41,\n            size: 10,\n            price: 110,\n            num: 1\n          },\n          {\n            id: 42,\n            size: 40,\n            price: 13,\n            num: 1\n          },\n          {\n            id: 43,\n            size: 50,\n            price: 13,\n            num: 1\n          }\n        ]\n      }\n    ],\n    // showSizeChoose: fasle,\n    src: 'http://img02.tooopen.com/images/20150928/tooopen_sy_143912755726.jpg'\n  },\n  // 领取优惠卷\n  getCoupon (e) {\n    let that = this\n    app.setToast(that, {image: '../../images/success.png', bgc: '#333', color: '#f30', content: '领取成功'})\n  },\n  // 菜单页数量选择\n  chooseMenuNum (e) {\n    if (e.currentTarget.dataset.type === 'del') {\n      --this.data.menuArr[e.currentTarget.dataset.index].num\n    } else {\n      if (!this.data.menuArr[e.currentTarget.dataset.index].num) {\n        this.data.menuArr[e.currentTarget.dataset.index].num = 1\n      } else {\n        ++this.data.menuArr[e.currentTarget.dataset.index].num\n      }\n    }\n    this.setData({\n      menuArr: this.data.menuArr\n    })\n    this.setGoodsStorage()\n  },\n  // 确定下单\n  confirm () {\n    wx.navigateTo({\n      url: `../submitOrder/submitOrder?money=${this.data.allMoney}`\n    })\n  },\n  // 尺寸选择弹窗\n  close (e) {\n    if (e.currentTarget.dataset.type === 'addCar') {\n      // todo  购物车相关计算逻辑\n      this.setGoodsStorage(true)\n    }\n    this.setData({\n      showIndex: e.currentTarget.dataset.index || this.data.showIndex,\n      showSizeChoose: !this.data.showSizeChoose,\n      sizeNum: 1\n    })\n  },\n  // 将选择的物品放置缓存\n  setGoodsStorage (size) {\n    let that = this\n    let goodsStorage = app.gs('goodsStorage') || []\n    if (size) { // 单独规格添加\n      // console.log(1)\n      if (goodsStorage.length < 1) {\n        goodsStorage.push({\n          img: that.data.menuArr[that.data.showIndex].img,\n          name: that.data.menuArr[that.data.showIndex].name,\n          price: that.data.menuArr[that.data.showIndex].sizeArr[that.data.sizeIndex].price,\n          id: that.data.menuArr[that.data.showIndex].sizeArr[that.data.sizeIndex].id,\n          size: that.data.menuArr[that.data.showIndex].sizeArr[that.data.sizeIndex].size,\n          num: that.data.sizeNum\n        })\n      } else {\n        for (let [i, v] of goodsStorage.entries()) {\n          if (v.id === that.data.menuArr[that.data.showIndex].sizeArr[that.data.sizeIndex].id) { // 如果存在\n            goodsStorage[i] = {\n              img: that.data.menuArr[that.data.showIndex].img,\n              name: that.data.menuArr[that.data.showIndex].name,\n              price: that.data.menuArr[that.data.showIndex].sizeArr[that.data.sizeIndex].price,\n              id: that.data.menuArr[that.data.showIndex].sizeArr[that.data.sizeIndex].id,\n              size: that.data.menuArr[that.data.showIndex].sizeArr[that.data.sizeIndex].size,\n              num: that.data.sizeNum\n            }\n            break\n          } else if (i === goodsStorage.length - 1) {\n            goodsStorage.push({\n              img: that.data.menuArr[that.data.showIndex].img,\n              name: that.data.menuArr[that.data.showIndex].name,\n              price: that.data.menuArr[that.data.showIndex].sizeArr[that.data.sizeIndex].price,\n              id: that.data.menuArr[that.data.showIndex].sizeArr[that.data.sizeIndex].id,\n              size: that.data.menuArr[that.data.showIndex].sizeArr[that.data.sizeIndex].size,\n              num: that.data.sizeNum\n            })\n          }\n        }\n      }\n    } else {\n      // console.log(2)\n      // 单独规格选择\n      for (let v of this.data.menuArr) {\n        if (v.sizeArr.length > 1) continue // 有规格的不添加\n        if (v.num >= 0) {\n          if (goodsStorage.length >= 1) {\n            for (let [i, m] of goodsStorage.entries()) {\n              if (m.id === v.id) { // 缓存中存在该项,重新赋值，跳出循环\n                goodsStorage[i] = v\n                break\n              } else if (i === goodsStorage.length - 1) {\n                goodsStorage.push(v)\n              }\n            }\n          } else {\n            goodsStorage.push(v)\n          }\n        }\n      }\n    }\n    let num = 0\n    for (let [i, v] of goodsStorage.entries()) {\n      if (v.num === 0) {\n        goodsStorage.splice(i, 1)\n      }\n      num += v.num\n    }\n    app.su('goodsStorage', goodsStorage)\n    this.calculatorMoney()\n    this.setData({\n      allCount: num,\n      sizeIndex: 0,\n      sizeNum: 1\n    })\n  },\n  // 计算总价格\n  calculatorMoney () {\n    let allMoney = 0\n    for (let v of app.gs('goodsStorage')) {\n      if (v.num) {\n        allMoney += v.num * v.price\n      }\n    }\n    if (allMoney <= 0) {\n      wx.removeStorageSync('goodsStorage')\n    }\n    this.setData({\n      allMoney\n    })\n  },\n  // 选择尺寸\n  chooseSize (e) {\n    this.setData({\n      sizeIndex: e.currentTarget.dataset.index,\n      sizeNum: 1\n    })\n  },\n  // 尺寸数量选择\n  chooseSizeNum (e) {\n    if (e.currentTarget.dataset.type === 'del') {\n      this.setData({\n        sizeNum: --this.data.sizeNum\n      })\n    } else {\n      this.setData({\n        sizeNum: ++this.data.sizeNum\n      })\n    }\n  },\n  // 顶栏选择\n  chooseTab (e) {\n    this.setData({\n      currentIndex: e.currentTarget.dataset.index\n    })\n  },\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad () {\n    // wx.removeStorageSync('goodsStorage')\n    // TODO: onLoad\n  },\n\n  /**\n   * 生命周期函数--监听页面初次渲染完成\n   */\n  onReady () {\n    // TODO: onReady\n  },\n\n  /**\n   * 生命周期函数--监听页面显示\n   */\n  onShow () {\n    let num = 0\n    for (let v of app.gs('goodsStorage')) {\n      num += parseInt(v.num)\n    }\n    this.calculatorMoney()\n    if (app.gs('goodsStorage')) {\n      if (app.gs('goodsStorage').length >= 1) {\n        for (let v of this.data.menuArr) {\n          for (let g of app.gs('goodsStorage')) {\n            if (g.id === v.id) {\n              v.num = g.num\n              break\n            } else {\n              v.num = 0\n            }\n          }\n        }\n      } else {\n        for (let s of this.data.menuArr) {\n          s.num = 0\n        }\n      }\n    } else {\n      for (let s of this.data.menuArr) {\n        s.num = 0\n      }\n    }\n    this.setData({\n      allCount: num,\n      menuArr: this.data.menuArr\n    })\n    // TODO: onShow\n  },\n\n  /**\n   * 生命周期函数--监听页面隐藏\n   */\n  onHide () {\n    // TODO: onHide\n  },\n\n  /**\n   * 生命周期函数--监听页面卸载\n   */\n  onUnload () {\n    // TODO: onUnload\n  },\n\n  /**\n   * 页面相关事件处理函数--监听用户下拉动作\n   */\n  onPullDownRefresh () {\n    // TODO: onPullDownRefresh\n  }\n})\n"]}