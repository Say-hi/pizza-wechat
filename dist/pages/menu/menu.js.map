{"version":3,"sources":["pages/menu/menu.js"],"names":["app","getApp","Page","data","currentIndex","sizeIndex","sizeNum","allMoney","chooseMenuNum","e","currentTarget","dataset","type","menuArr","list","index","num","setData","setGoodsStorage","confirm","setToast","content","goodsStorage","gs","v","su","wx","navigateTo","url","close","showIndex","toString","showSizeChoose","size","that","length","push","img","src","name","goodsname","price","spec","id","s_id","spec_name","entries","i","m","splice","calculatorMoney","allCount","removeStorageSync","chooseSize","chooseSizeNum","chooseTab","t_id","getMenuData","wxrequest","getUrl","menu","session3rd","success","res","code","hideLoading","menuTabArr","typename","msg","getCoupon","getcoupon","c_id","image","bgc","color","onLoad","onReady","onShow","timer","setTimeout","parseInt","outv","g","g_id","s","onHide","onUnload","onPullDownRefresh"],"mappings":"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","file":"menu.js","sourcesContent":["// 获取全局应用程序实例对象\nconst app = getApp()\n\n// 创建页面实例对象\nPage({\n  /**\n   * 页面的初始数据\n   */\n  data: {\n    currentIndex: 0,\n    sizeIndex: 0,\n    sizeNum: 1,\n    allMoney: 0\n  },\n  // 菜单页数量选择\n  chooseMenuNum (e) {\n    if (e.currentTarget.dataset.type === 'del') {\n      --this.data.menuArr[this.data.currentIndex].list[e.currentTarget.dataset.index].num\n    } else {\n      if (!this.data.menuArr[this.data.currentIndex].list[e.currentTarget.dataset.index].num) {\n        this.data.menuArr[this.data.currentIndex].list[e.currentTarget.dataset.index].num = 1\n      } else {\n        ++this.data.menuArr[this.data.currentIndex].list[e.currentTarget.dataset.index].num\n      }\n    }\n    this.setData({\n      menuArr: this.data.menuArr\n    })\n    this.setGoodsStorage()\n  },\n  // 确定下单\n  confirm () {\n    if (this.data.allMoney * 1 === 0) return app.setToast(this, {content: '您还没有选择商品咧'})\n    let goodsStorage = app.gs('goodsStorage')\n    for (let v of goodsStorage) {\n      v['checked'] = true\n    }\n    app.su('goodsStorage', goodsStorage)\n    wx.navigateTo({\n      url: `../submitOrder/submitOrder?money=${this.data.allMoney}`\n    })\n  },\n  // 尺寸选择弹窗\n  close (e) {\n    if (e.currentTarget.dataset.type === 'addCar') {\n      // todo  购物车相关计算逻辑\n      this.setGoodsStorage(true)\n    }\n    this.setData({\n      showIndex: e.currentTarget.dataset.index.toString() || this.data.showIndex,\n      showSizeChoose: !this.data.showSizeChoose,\n      sizeNum: 1\n    })\n  },\n  // 将选择的物品放置缓存\n  setGoodsStorage (size) {\n    let that = this\n    let goodsStorage = app.gs('goodsStorage') || []\n    if (size) { // 单独规格添加\n      if (goodsStorage.length < 1) {\n        goodsStorage.push({\n          img: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].src,\n          name: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].goodsname,\n          price: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].price,\n          id: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].s_id || 0,\n          size: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].spec_name,\n          num: that.data.sizeNum\n        })\n      } else {\n        for (let [i, v] of goodsStorage.entries()) {\n          if (v.id === that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].s_id) { // 如果存在\n            goodsStorage[i] = {\n              img: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].src,\n              name: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].goodsname,\n              price: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].price,\n              id: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].s_id,\n              size: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].spec_name,\n              num: that.data.sizeNum\n            }\n            break\n          } else if (i === goodsStorage.length - 1) {\n            goodsStorage.push({\n              img: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].src,\n              name: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].goodsname,\n              price: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].price,\n              id: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].s_id,\n              size: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].spec_name,\n              num: that.data.sizeNum\n            })\n          }\n        }\n      }\n    } else {\n      // 单独规格选择\n      for (let v of this.data.menuArr[this.data.currentIndex].list) {\n        if (v.spec.length >= 1) continue // 有规格的不添加\n        if (v.num >= 0) {\n          if (goodsStorage.length >= 1) {\n            for (let [i, m] of goodsStorage.entries()) {\n              if (m.id === v.s_id || m.s_id === v.s_id) { // 缓存中存在该项,重新赋值，跳出循环\n                goodsStorage[i] = v\n                break\n              } else if (i === goodsStorage.length - 1) {\n                goodsStorage.push(v)\n              }\n            }\n          } else {\n            goodsStorage.push(v)\n          }\n        }\n      }\n    }\n    let num = 0\n    for (let [i, v] of goodsStorage.entries()) {\n      if (v.num === 0) {\n        goodsStorage.splice(i, 1)\n      }\n      num += v.num\n    }\n    app.su('goodsStorage', goodsStorage)\n    this.calculatorMoney()\n    this.setData({\n      allCount: num,\n      sizeIndex: 0,\n      sizeNum: 1\n    })\n  },\n  // 计算总价格\n  calculatorMoney () {\n    let allMoney = 0\n    for (let v of app.gs('goodsStorage')) {\n      if (v.num) {\n        allMoney += v.num * v.price\n      }\n    }\n    if (allMoney <= 0) {\n      wx.removeStorageSync('goodsStorage')\n    }\n    this.setData({\n      allMoney\n    })\n  },\n  // 选择尺寸\n  chooseSize (e) {\n    this.setData({\n      sizeIndex: e.currentTarget.dataset.index,\n      sizeNum: 1\n    })\n  },\n  // 尺寸数量选择\n  chooseSizeNum (e) {\n    if (e.currentTarget.dataset.type === 'del') {\n      this.setData({\n        sizeNum: --this.data.sizeNum\n      })\n    } else {\n      this.setData({\n        sizeNum: ++this.data.sizeNum\n      })\n    }\n  },\n  // 顶栏选择\n  chooseTab (e) {\n    this.setData({\n      currentIndex: e.currentTarget.dataset.index,\n      t_id: e.currentTarget.dataset.id\n    })\n  },\n  // 获取菜单\n  getMenuData () {\n    let that = this\n    app.wxrequest({\n      url: app.getUrl().menu,\n      data: {\n        session3rd: app.gs()\n      },\n      success (res) {\n        if (res.data.code === '200') {\n          wx.hideLoading()\n          let menuTabArr = []\n          for (let i in res.data.data) {\n            if (res.data.data[i].t_id) {\n              menuTabArr.push({name: res.data.data[i].typename, t_id: res.data.data[i].t_id})\n            }\n          }\n          that.setData({\n            menuArr: res.data.data,\n            t_id: menuTabArr[0].t_id,\n            menuTabArr\n          })\n        } else {\n          app.setToast(that, {content: res.data.msg})\n        }\n      }\n    })\n  },\n  // 领取优惠卷\n  getCoupon (e) {\n    let that = this\n    app.wxrequest({\n      url: app.getUrl().getcoupon,\n      data: {\n        session3rd: app.gs(),\n        c_id: e.currentTarget.dataset.id\n      },\n      success (res) {\n        wx.hideLoading()\n        if (res.data.code === '200') {\n          app.setToast(that, {image: '../../images/success.png', bgc: '#333', color: '#f30', content: '领取成功'})\n        } else {\n          app.setToast(that, {content: res.data.msg})\n        }\n      }\n    })\n  },\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad () {\n    this.getMenuData()\n    // TODO: onLoad\n  },\n\n  /**\n   * 生命周期函数--监听页面初次渲染完成\n   */\n  onReady () {\n    // TODO: onReady\n  },\n\n  /**\n   * 生命周期函数--监听页面显示\n   */\n  onShow () {\n    let num = 0\n    let timer = ''\n    timer = setTimeout(() => {\n      if (this.data.menuArr) {\n        for (let v of app.gs('goodsStorage')) {\n          num += parseInt(v.num)\n        }\n        this.calculatorMoney()\n        if (app.gs('goodsStorage')) {\n          if (app.gs('goodsStorage').length >= 1) {\n            for (let outv in this.data.menuArr) {\n              if (outv !== 'coupon') {\n                for (let v of this.data.menuArr[outv].list) {\n                  for (let g of app.gs('goodsStorage')) {\n                    if (g.g_id === v.g_id) {\n                      v.num = g.num\n                      break\n                    } else {\n                      v.num = 0\n                    }\n                  }\n                }\n              }\n            }\n          } else {\n            for (let s in this.data.menuArr) {\n              if (s !== 'coupon') {\n                for (let m of this.data.menuArr[s].list) {\n                  m.num = 0\n                }\n              }\n            }\n          }\n        } else {\n          for (let s in this.data.menuArr) {\n            if (s !== 'coupon') {\n              for (let m of this.data.menuArr[s].list) {\n                m.num = 0\n              }\n            }\n          }\n        }\n        this.setData({\n          allCount: num,\n          menuArr: this.data.menuArr\n        })\n      } else {\n        timer()\n      }\n    }, 100)\n    // TODO: onShow\n  },\n\n  /**\n   * 生命周期函数--监听页面隐藏\n   */\n  onHide () {\n    // TODO: onHide\n  },\n\n  /**\n   * 生命周期函数--监听页面卸载\n   */\n  onUnload () {\n    // TODO: onUnload\n  },\n\n  /**\n   * 页面相关事件处理函数--监听用户下拉动作\n   */\n  onPullDownRefresh () {\n    // TODO: onPullDownRefresh\n  }\n})\n"]}