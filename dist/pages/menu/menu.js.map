{"version":3,"sources":["pages/menu/menu.js"],"names":["app","getApp","Page","data","currentIndex","sizeIndex","sizeNum","allMoney","getCoupon","e","that","setToast","image","bgc","color","content","chooseMenuNum","currentTarget","dataset","type","menuArr","list","index","num","setData","setGoodsStorage","confirm","goodsStorage","gs","v","su","wx","navigateTo","url","close","showIndex","toString","showSizeChoose","size","length","push","img","src","name","goodsname","price","spec","id","s_id","spec_name","entries","i","m","splice","calculatorMoney","allCount","removeStorageSync","chooseSize","chooseSizeNum","chooseTab","t_id","getMenuData","wxrequest","getUrl","menu","session3rd","success","res","code","hideLoading","menuTabArr","typename","msg","onLoad","onReady","onShow","timer","setTimeout","parseInt","outv","g","g_id","s","onHide","onUnload","onPullDownRefresh"],"mappings":"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","file":"menu.js","sourcesContent":["// 获取全局应用程序实例对象\nconst app = getApp()\n\n// 创建页面实例对象\nPage({\n  /**\n   * 页面的初始数据\n   */\n  data: {\n    currentIndex: 0,\n    sizeIndex: 0,\n    sizeNum: 1,\n    allMoney: 0\n  },\n  // 领取优惠卷\n  getCoupon (e) {\n    let that = this\n    app.setToast(that, {image: '../../images/success.png', bgc: '#333', color: '#f30', content: '领取成功'})\n  },\n  // 菜单页数量选择\n  chooseMenuNum (e) {\n    if (e.currentTarget.dataset.type === 'del') {\n      --this.data.menuArr[this.data.currentIndex].list[e.currentTarget.dataset.index].num\n    } else {\n      if (!this.data.menuArr[this.data.currentIndex].list[e.currentTarget.dataset.index].num) {\n        this.data.menuArr[this.data.currentIndex].list[e.currentTarget.dataset.index].num = 1\n      } else {\n        ++this.data.menuArr[this.data.currentIndex].list[e.currentTarget.dataset.index].num\n      }\n    }\n    this.setData({\n      menuArr: this.data.menuArr\n    })\n    this.setGoodsStorage()\n  },\n  // 确定下单\n  confirm () {\n    if (this.data.allMoney * 1 === 0) return app.setToast(this, {content: '您还没有选择商品咧'})\n    let goodsStorage = app.gs('goodsStorage')\n    for (let v of goodsStorage) {\n      v['checked'] = true\n    }\n    app.su('goodsStorage', goodsStorage)\n    wx.navigateTo({\n      url: `../submitOrder/submitOrder?money=${this.data.allMoney}`\n    })\n  },\n  // 尺寸选择弹窗\n  close (e) {\n    if (e.currentTarget.dataset.type === 'addCar') {\n      // todo  购物车相关计算逻辑\n      this.setGoodsStorage(true)\n    }\n    this.setData({\n      showIndex: e.currentTarget.dataset.index.toString() || this.data.showIndex,\n      showSizeChoose: !this.data.showSizeChoose,\n      sizeNum: 1\n    })\n  },\n  // 将选择的物品放置缓存\n  setGoodsStorage (size) {\n    let that = this\n    let goodsStorage = app.gs('goodsStorage') || []\n    if (size) { // 单独规格添加\n      if (goodsStorage.length < 1) {\n        goodsStorage.push({\n          img: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].src,\n          name: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].goodsname,\n          price: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].price,\n          id: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].s_id || 0,\n          size: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].spec_name,\n          num: that.data.sizeNum\n        })\n      } else {\n        for (let [i, v] of goodsStorage.entries()) {\n          if (v.id === that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].s_id) { // 如果存在\n            goodsStorage[i] = {\n              img: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].src,\n              name: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].goodsname,\n              price: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].price,\n              id: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].s_id,\n              size: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].spec_name,\n              num: that.data.sizeNum\n            }\n            break\n          } else if (i === goodsStorage.length - 1) {\n            goodsStorage.push({\n              img: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].src,\n              name: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].goodsname,\n              price: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].price,\n              id: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].s_id,\n              size: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].spec_name,\n              num: that.data.sizeNum\n            })\n          }\n        }\n      }\n    } else {\n      // 单独规格选择\n      for (let v of this.data.menuArr[this.data.currentIndex].list) {\n        if (v.spec.length >= 1) continue // 有规格的不添加\n        if (v.num >= 0) {\n          if (goodsStorage.length >= 1) {\n            for (let [i, m] of goodsStorage.entries()) {\n              if (m.id === v.s_id || m.s_id === v.s_id) { // 缓存中存在该项,重新赋值，跳出循环\n                goodsStorage[i] = v\n                break\n              } else if (i === goodsStorage.length - 1) {\n                goodsStorage.push(v)\n              }\n            }\n          } else {\n            goodsStorage.push(v)\n          }\n        }\n      }\n    }\n    let num = 0\n    for (let [i, v] of goodsStorage.entries()) {\n      if (v.num === 0) {\n        goodsStorage.splice(i, 1)\n      }\n      num += v.num\n    }\n    app.su('goodsStorage', goodsStorage)\n    this.calculatorMoney()\n    this.setData({\n      allCount: num,\n      sizeIndex: 0,\n      sizeNum: 1\n    })\n  },\n  // 计算总价格\n  calculatorMoney () {\n    let allMoney = 0\n    for (let v of app.gs('goodsStorage')) {\n      if (v.num) {\n        allMoney += v.num * v.price\n      }\n    }\n    if (allMoney <= 0) {\n      wx.removeStorageSync('goodsStorage')\n    }\n    this.setData({\n      allMoney\n    })\n  },\n  // 选择尺寸\n  chooseSize (e) {\n    this.setData({\n      sizeIndex: e.currentTarget.dataset.index,\n      sizeNum: 1\n    })\n  },\n  // 尺寸数量选择\n  chooseSizeNum (e) {\n    if (e.currentTarget.dataset.type === 'del') {\n      this.setData({\n        sizeNum: --this.data.sizeNum\n      })\n    } else {\n      this.setData({\n        sizeNum: ++this.data.sizeNum\n      })\n    }\n  },\n  // 顶栏选择\n  chooseTab (e) {\n    this.setData({\n      currentIndex: e.currentTarget.dataset.index,\n      t_id: e.currentTarget.dataset.id\n    })\n  },\n  // 获取菜单\n  getMenuData () {\n    let that = this\n    app.wxrequest({\n      url: app.getUrl().menu,\n      data: {\n        session3rd: app.gs()\n      },\n      success (res) {\n        if (res.data.code === '200') {\n          wx.hideLoading()\n          let menuTabArr = []\n          for (let i in res.data.data) {\n            if (res.data.data[i].t_id) {\n              menuTabArr.push({name: res.data.data[i].typename, t_id: res.data.data[i].t_id})\n            }\n          }\n          that.setData({\n            menuArr: res.data.data,\n            t_id: menuTabArr[0].t_id,\n            menuTabArr\n          })\n        } else {\n          app.setToast(that, {content: res.data.msg})\n        }\n      }\n    })\n  },\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad () {\n    this.getMenuData()\n    // TODO: onLoad\n  },\n\n  /**\n   * 生命周期函数--监听页面初次渲染完成\n   */\n  onReady () {\n    // TODO: onReady\n  },\n\n  /**\n   * 生命周期函数--监听页面显示\n   */\n  onShow () {\n    let num = 0\n    let timer = ''\n    timer = setTimeout(() => {\n      if (this.data.menuArr) {\n        for (let v of app.gs('goodsStorage')) {\n          num += parseInt(v.num)\n        }\n        this.calculatorMoney()\n        if (app.gs('goodsStorage')) {\n          if (app.gs('goodsStorage').length >= 1) {\n            for (let outv in this.data.menuArr) {\n              if (outv !== 'coupon') {\n                for (let v of this.data.menuArr[outv].list) {\n                  for (let g of app.gs('goodsStorage')) {\n                    if (g.g_id === v.g_id) {\n                      v.num = g.num\n                      break\n                    } else {\n                      v.num = 0\n                    }\n                  }\n                }\n              }\n            }\n          } else {\n            for (let s in this.data.menuArr) {\n              if (s !== 'coupon') {\n                for (let m of this.data.menuArr[s].list) {\n                  m.num = 0\n                }\n              }\n            }\n          }\n        } else {\n          for (let s in this.data.menuArr) {\n            if (s !== 'coupon') {\n              for (let m of this.data.menuArr[s].list) {\n                m.num = 0\n              }\n            }\n          }\n        }\n        this.setData({\n          allCount: num,\n          menuArr: this.data.menuArr\n        })\n      } else {\n        timer()\n      }\n    }, 100)\n    // TODO: onShow\n  },\n\n  /**\n   * 生命周期函数--监听页面隐藏\n   */\n  onHide () {\n    // TODO: onHide\n  },\n\n  /**\n   * 生命周期函数--监听页面卸载\n   */\n  onUnload () {\n    // TODO: onUnload\n  },\n\n  /**\n   * 页面相关事件处理函数--监听用户下拉动作\n   */\n  onPullDownRefresh () {\n    // TODO: onPullDownRefresh\n  }\n})\n"]}