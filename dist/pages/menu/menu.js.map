{"version":3,"sources":["pages/menu/menu.js"],"names":["app","getApp","Page","data","currentIndex","sizeIndex","sizeNum","allMoney","chooseMenuNum","e","currentTarget","dataset","type","menuArr","list","index","num","setData","setGoodsStorage","confirm","setToast","content","dispatch","goodsStorage","gs","v","su","wx","navigateTo","url","close","showIndex","toString","showSizeChoose","size","that","length","push","img","src","name","goodsname","price","spec","id","s_id","spec_name","entries","i","m","splice","calculatorMoney","allCount","removeStorageSync","toFixed","chooseSize","chooseSizeNum","chooseTab","t_id","getMenuData","wxrequest","getUrl","menu","session3rd","success","res","code","hideLoading","menuTabArr","typename","msg","getCoupon","getcoupon","c_id","image","bgc","color","onLoad","onReady","onShow","shop","timer","setTimeout","parseInt","outv","g","g_id","s","onHide","onUnload","onPullDownRefresh"],"mappings":"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","file":"menu.js","sourcesContent":["// 获取全局应用程序实例对象\nconst app = getApp()\n\n// 创建页面实例对象\nPage({\n  /**\n   * 页面的初始数据\n   */\n  data: {\n    currentIndex: 0,\n    sizeIndex: 0,\n    sizeNum: 1,\n    allMoney: 0\n  },\n  // 菜单页数量选择\n  chooseMenuNum (e) {\n    if (e.currentTarget.dataset.type === 'del') {\n      --this.data.menuArr[this.data.currentIndex].list[e.currentTarget.dataset.index].num\n    } else {\n      if (!this.data.menuArr[this.data.currentIndex].list[e.currentTarget.dataset.index].num) {\n        this.data.menuArr[this.data.currentIndex].list[e.currentTarget.dataset.index].num = 1\n      } else {\n        ++this.data.menuArr[this.data.currentIndex].list[e.currentTarget.dataset.index].num\n      }\n    }\n    this.setData({\n      menuArr: this.data.menuArr\n    })\n    this.setGoodsStorage()\n  },\n  // 确定下单\n  confirm () {\n    if (this.data.allMoney * 1 === 0) return app.setToast(this, {content: '您还没有选择商品咧'})\n    if (this.data.allMoney < this.data.dispatch) return app.setToast(this, {content: `抱歉，起送金额为${this.data.dispatch}元哦`})\n    let goodsStorage = app.gs('goodsStorage')\n    for (let v of goodsStorage) {\n      v['checked'] = true\n    }\n    app.su('goodsStorage', goodsStorage)\n    wx.navigateTo({\n      url: `../submitOrder/submitOrder?money=${this.data.allMoney}`\n    })\n  },\n  // 尺寸选择弹窗\n  close (e) {\n    if (e.currentTarget.dataset.type === 'addCar') {\n      // todo  购物车相关计算逻辑\n      this.setGoodsStorage(true)\n    }\n    this.setData({\n      showIndex: e.currentTarget.dataset.index.toString() || this.data.showIndex,\n      showSizeChoose: !this.data.showSizeChoose,\n      sizeNum: 1\n    })\n  },\n  // 将选择的物品放置缓存\n  setGoodsStorage (size) {\n    let that = this\n    let goodsStorage = app.gs('goodsStorage') || []\n    if (size) { // 单独规格添加\n      if (goodsStorage.length < 1) {\n        goodsStorage.push({\n          img: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].src,\n          name: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].goodsname,\n          price: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].price,\n          id: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].s_id || 0,\n          size: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].spec_name,\n          num: that.data.sizeNum\n        })\n      } else {\n        for (let [i, v] of goodsStorage.entries()) {\n          if (v.id === that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].s_id) { // 如果存在\n            goodsStorage[i] = {\n              img: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].src,\n              name: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].goodsname,\n              price: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].price,\n              id: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].s_id,\n              size: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].spec_name,\n              num: that.data.sizeNum\n            }\n            break\n          } else if (i === goodsStorage.length - 1) {\n            goodsStorage.push({\n              img: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].src,\n              name: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].goodsname,\n              price: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].price,\n              id: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].s_id,\n              size: that.data.menuArr[that.data.currentIndex].list[that.data.showIndex].spec[that.data.sizeIndex].spec_name,\n              num: that.data.sizeNum\n            })\n          }\n        }\n      }\n    } else {\n      // 单独规格选择\n      for (let v of this.data.menuArr[this.data.currentIndex].list) {\n        if (v.spec.length >= 1) continue // 有规格的不添加\n        if (v.num >= 0) {\n          if (goodsStorage.length >= 1) {\n            for (let [i, m] of goodsStorage.entries()) {\n              if (m.id === v.s_id || m.s_id === v.s_id) { // 缓存中存在该项,重新赋值，跳出循环\n                goodsStorage[i] = v\n                break\n              } else if (i === goodsStorage.length - 1) {\n                goodsStorage.push(v)\n              }\n            }\n          } else {\n            goodsStorage.push(v)\n          }\n        }\n      }\n    }\n    let num = 0\n    for (let [i, v] of goodsStorage.entries()) {\n      if (v.num === 0) {\n        goodsStorage.splice(i, 1)\n      }\n      num += v.num\n    }\n    app.su('goodsStorage', goodsStorage)\n    this.calculatorMoney()\n    this.setData({\n      allCount: num,\n      sizeIndex: 0,\n      sizeNum: 1\n    })\n  },\n  // 计算总价格\n  calculatorMoney () {\n    let allMoney = 0\n    for (let v of app.gs('goodsStorage')) {\n      if (v.num) {\n        allMoney += v.num * v.price\n      }\n    }\n    if (allMoney <= 0) {\n      wx.removeStorageSync('goodsStorage')\n    }\n    this.setData({\n      allMoney: allMoney.toFixed(2)\n    })\n  },\n  // 选择尺寸\n  chooseSize (e) {\n    this.setData({\n      sizeIndex: e.currentTarget.dataset.index,\n      sizeNum: 1\n    })\n  },\n  // 尺寸数量选择\n  chooseSizeNum (e) {\n    if (e.currentTarget.dataset.type === 'del') {\n      this.setData({\n        sizeNum: --this.data.sizeNum\n      })\n    } else {\n      this.setData({\n        sizeNum: ++this.data.sizeNum\n      })\n    }\n  },\n  // 顶栏选择\n  chooseTab (e) {\n    this.setData({\n      currentIndex: e.currentTarget.dataset.index,\n      t_id: e.currentTarget.dataset.id\n    })\n  },\n  // 获取菜单\n  getMenuData () {\n    let that = this\n    app.wxrequest({\n      url: app.getUrl().menu,\n      data: {\n        session3rd: app.gs()\n      },\n      success (res) {\n        if (res.data.code === '200') {\n          wx.hideLoading()\n          let menuTabArr = []\n          for (let i in res.data.data) {\n            if (res.data.data[i].t_id) {\n              menuTabArr.push({name: res.data.data[i].typename, t_id: res.data.data[i].t_id})\n            }\n          }\n          that.setData({\n            menuArr: res.data.data,\n            t_id: menuTabArr[0].t_id,\n            menuTabArr\n          })\n        } else {\n          app.setToast(that, {content: res.data.msg})\n        }\n      }\n    })\n  },\n  // 领取优惠卷\n  getCoupon (e) {\n    let that = this\n    app.wxrequest({\n      url: app.getUrl().getcoupon,\n      data: {\n        session3rd: app.gs(),\n        c_id: e.currentTarget.dataset.id\n      },\n      success (res) {\n        wx.hideLoading()\n        if (res.data.code === '200') {\n          app.setToast(that, {image: '../../images/success.png', bgc: '#333', color: '#f30', content: '领取成功'})\n        } else {\n          app.setToast(that, {content: res.data.msg})\n        }\n      }\n    })\n  },\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad () {\n    this.getMenuData()\n\n    // TODO: onLoad\n  },\n\n  /**\n   * 生命周期函数--监听页面初次渲染完成\n   */\n  onReady () {\n    // TODO: onReady\n  },\n\n  /**\n   * 生命周期函数--监听页面显示\n   */\n  onShow () {\n    this.setData({\n      dispatch: app.gs('shop').shop.dispatch\n    })\n    let num = 0\n    let timer = ''\n    timer = setTimeout(() => {\n      if (this.data.menuArr) {\n        for (let v of app.gs('goodsStorage')) {\n          num += parseInt(v.num)\n        }\n        this.calculatorMoney()\n        if (app.gs('goodsStorage')) {\n          if (app.gs('goodsStorage').length >= 1) {\n            for (let outv in this.data.menuArr) {\n              if (outv !== 'coupon') {\n                for (let v of this.data.menuArr[outv].list) {\n                  for (let g of app.gs('goodsStorage')) {\n                    if (g.g_id === v.g_id) {\n                      v.num = g.num\n                      break\n                    } else {\n                      v.num = 0\n                    }\n                  }\n                }\n              }\n            }\n          } else {\n            for (let s in this.data.menuArr) {\n              if (s !== 'coupon') {\n                for (let m of this.data.menuArr[s].list) {\n                  m.num = 0\n                }\n              }\n            }\n          }\n        } else {\n          for (let s in this.data.menuArr) {\n            if (s !== 'coupon') {\n              for (let m of this.data.menuArr[s].list) {\n                m.num = 0\n              }\n            }\n          }\n        }\n        this.setData({\n          allCount: num,\n          menuArr: this.data.menuArr\n        })\n      } else {\n        timer()\n      }\n    }, 100)\n    // TODO: onShow\n  },\n\n  /**\n   * 生命周期函数--监听页面隐藏\n   */\n  onHide () {\n    // TODO: onHide\n  },\n\n  /**\n   * 生命周期函数--监听页面卸载\n   */\n  onUnload () {\n    // TODO: onUnload\n  },\n\n  /**\n   * 页面相关事件处理函数--监听用户下拉动作\n   */\n  onPullDownRefresh () {\n    // TODO: onPullDownRefresh\n  }\n})\n"]}