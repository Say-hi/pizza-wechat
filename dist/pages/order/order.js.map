{"version":3,"sources":["pages/order/order.js"],"names":["app","getApp","Page","data","orderArr","currentIndex","page","getOrderData","status","that","wxrequest","url","getUrl","myorder","session3rd","gs","success","res","wx","hideLoading","stopPullDownRefresh","code","v","allMoney","detail","i","num","price","setData","concat","more","length","setToast","content","msg","chooseTab","e","currentTarget","dataset","index","delOrder","showToast","title","orderOperation","o_id","id","type","splice","onLoad","onReachBottom","onReady","onShow","onHide","onUnload","onPullDownRefresh"],"mappings":"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","file":"order.js","sourcesContent":["// 获取全局应用程序实例对象\nconst app = getApp()\n\n// 创建页面实例对象\nPage({\n  /**\n   * 页面的初始数据\n   */\n  data: {\n    orderArr: [],\n    currentIndex: 0,\n    page: 0\n  },\n  getOrderData (page = 0, status = '') {\n    let that = this\n    app.wxrequest({\n      url: app.getUrl().myorder,\n      data: {\n        session3rd: app.gs(),\n        page,\n        status\n      },\n      success (res) {\n        wx.hideLoading()\n        wx.stopPullDownRefresh()\n        if (res.data.code === '200') {\n          for (let v of res.data.data) {\n            let allMoney = 0\n            for (let i of v.detail) {\n              allMoney += i.num * i.price\n            }\n            v['allMoney'] = allMoney\n          }\n          that.setData({\n            orderArr: that.data.orderArr.concat(res.data.data),\n            more: res.data.data.length < 10 ? 0 : 1\n          })\n        } else {\n          app.setToast(that, {content: res.data.msg})\n        }\n      }\n    })\n  },\n  chooseTab (e) {\n    this.setData({\n      currentIndex: e.currentTarget.dataset.index,\n      page: 0,\n      orderArr: []\n    })\n    this.getOrderData(0, this.data.currentIndex ? this.data.currentIndex : '')\n  },\n  delOrder (e) {\n    wx.showToast({\n      title: '模拟删除'\n    })\n  },\n  orderOperation (e) {\n    let that = this\n    app.wxrequest({\n      url: app.getUrl().delOrder,\n      data: {\n        session3rd: app.gs(),\n        o_id: e.currentTarget.dataset.id,\n        status: e.currentTarget.dataset.type * 1\n      },\n      success (res) {\n        wx.hideLoading()\n        if (res.data.code === '200') {\n          that.data.orderArr.splice(e.currentTarget.dataset.index, 1)\n          that.setData({\n            orderArr: that.data.orderArr\n          })\n          wx.showToast({\n            title: '操作成功'\n          })\n        } else {\n          app.setToast(that, {content: res.data.msg})\n        }\n      }\n    })\n  },\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad () {\n    this.getOrderData()\n    // TODO: onLoad\n  },\n  onReachBottom () {\n    if (!this.data.more) return app.setToast(this, {content: '您没有更多的订单啦'})\n    // let that = this\n    this.getOrderData(++this.data.page, this.data.currentIndex ? this.data.currentIndex : '')\n  },\n  /**\n   * 生命周期函数--监听页面初次渲染完成\n   */\n  onReady () {\n    // TODO: onReady\n  },\n\n  /**\n   * 生命周期函数--监听页面显示\n   */\n  onShow () {\n    // TODO: onShow\n  },\n\n  /**\n   * 生命周期函数--监听页面隐藏\n   */\n  onHide () {\n    // TODO: onHide\n  },\n\n  /**\n   * 生命周期函数--监听页面卸载\n   */\n  onUnload () {\n    // TODO: onUnload\n  },\n\n  /**\n   * 页面相关事件处理函数--监听用户下拉动作\n   */\n  onPullDownRefresh () {\n    this.setData({\n      page: 0,\n      orderArr: []\n    })\n    this.getOrderData(0, this.data.currentIndex ? this.data.currentIndex : '')\n    // TODO: onPullDownRefresh\n  }\n})\n"]}