{"version":3,"sources":["pages/order/order.js"],"names":["app","getApp","Page","data","orderArr","currentIndex","needshowindex","page","getOrderData","status","that","wxrequest","url","getUrl","myorder","session3rd","gs","success","res","wx","hideLoading","stopPullDownRefresh","code","v","allMoney","detail","i","num","price","setData","concat","more","length","setToast","content","msg","chooseTab","e","currentTarget","dataset","index","delOrder","showToast","title","orderOperation","o_id","id","type","splice","cuidan","call","shop","tel","showAll","onLoad","onReachBottom","onReady","onShow","onHide","onUnload","onPullDownRefresh"],"mappings":"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","file":"order.js","sourcesContent":["// 获取全局应用程序实例对象\nconst app = getApp()\n\n// 创建页面实例对象\nPage({\n  /**\n   * 页面的初始数据\n   */\n  data: {\n    orderArr: [],\n    currentIndex: 0,\n    needshowindex: -1,\n    page: 0\n  },\n  getOrderData (page = 0, status = '') {\n    let that = this\n    app.wxrequest({\n      url: app.getUrl().myorder,\n      data: {\n        session3rd: app.gs(),\n        page,\n        status\n      },\n      success (res) {\n        wx.hideLoading()\n        wx.stopPullDownRefresh()\n        if (res.data.code === '200') {\n          for (let v of res.data.data) {\n            let allMoney = 0\n            for (let i of v.detail) {\n              allMoney += i.num * i.price\n            }\n            v['allMoney'] = allMoney\n          }\n          that.setData({\n            orderArr: that.data.orderArr.concat(res.data.data),\n            more: res.data.data.length < 10 ? 0 : 1\n          })\n        } else {\n          app.setToast(that, {content: res.data.msg})\n        }\n      }\n    })\n  },\n  chooseTab (e) {\n    this.setData({\n      currentIndex: e.currentTarget.dataset.index,\n      page: 0,\n      orderArr: []\n    })\n    this.getOrderData(0, this.data.currentIndex ? this.data.currentIndex : '')\n  },\n  delOrder (e) {\n    wx.showToast({\n      title: '模拟删除'\n    })\n  },\n  orderOperation (e) {\n    let that = this\n    app.wxrequest({\n      url: app.getUrl().delOrder,\n      data: {\n        session3rd: app.gs(),\n        o_id: e.currentTarget.dataset.id,\n        status: e.currentTarget.dataset.type * 1\n      },\n      success (res) {\n        wx.hideLoading()\n        if (res.data.code === '200') {\n          that.data.orderArr.splice(e.currentTarget.dataset.index, 1)\n          that.setData({\n            orderArr: that.data.orderArr\n          })\n          wx.showToast({\n            title: '操作成功'\n          })\n        } else {\n          app.setToast(that, {content: res.data.msg})\n        }\n      }\n    })\n  },\n  cuidan () {\n    app.call(app.gs('shop').shop.tel)\n  },\n  showAll (e) {\n    this.setData({\n      needshowindex: e.currentTarget.dataset.index\n    })\n  },\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad () {\n    this.getOrderData()\n    // TODO: onLoad\n  },\n  onReachBottom () {\n    if (!this.data.more) return app.setToast(this, {content: '您没有更多的订单啦'})\n    // let that = this\n    this.getOrderData(++this.data.page, this.data.currentIndex ? this.data.currentIndex : '')\n  },\n  /**\n   * 生命周期函数--监听页面初次渲染完成\n   */\n  onReady () {\n    // TODO: onReady\n  },\n\n  /**\n   * 生命周期函数--监听页面显示\n   */\n  onShow () {\n    // TODO: onShow\n  },\n\n  /**\n   * 生命周期函数--监听页面隐藏\n   */\n  onHide () {\n    // TODO: onHide\n  },\n\n  /**\n   * 生命周期函数--监听页面卸载\n   */\n  onUnload () {\n    // TODO: onUnload\n  },\n\n  /**\n   * 页面相关事件处理函数--监听用户下拉动作\n   */\n  onPullDownRefresh () {\n    this.setData({\n      page: 0,\n      orderArr: []\n    })\n    this.getOrderData(0, this.data.currentIndex ? this.data.currentIndex : '')\n    // TODO: onPullDownRefresh\n  }\n})\n"]}