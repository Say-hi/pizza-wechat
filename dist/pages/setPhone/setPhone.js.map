{"version":3,"sources":["pages/setPhone/setPhone.js"],"names":["app","getApp","Page","data","title","text","getCode","phone","that","wxrequest","url","getUrl","getcode","session3rd","gs","success","res","wx","hideLoading","code","lostTime","showToast","setToast","content","msg","confirm","e","detail","target","dataset","type","checkMobile","value","bind","setTimeout","navigateBack","delta","time","timer","setInterval","setData","disabled","clearInterval","onLoad","onReady","onShow","onHide","onUnload","onPullDownRefresh"],"mappings":"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","file":"setPhone.js","sourcesContent":["// 获取全局应用程序实例对象\nconst app = getApp()\n\n// 创建页面实例对象\nPage({\n  /**\n   * 页面的初始数据\n   */\n  data: {\n    title: 'setPhone',\n    text: '获取验证码'\n  },\n  getCode (phone) {\n    let that = this\n    app.wxrequest({\n      url: app.getUrl().getcode,\n      data: {\n        session3rd: app.gs(),\n        phone\n      },\n      success (res) {\n        wx.hideLoading()\n        if (res.data.code === '200') {\n          that.lostTime()\n          wx.showToast({\n            title: '请查收验证码'\n          })\n        } else {\n          app.setToast(that, {content: res.data.msg})\n        }\n      }\n    })\n  },\n  confirm (e) {\n    let that = this\n    if (e.detail.target.dataset.type === 'code') {\n      if (app.checkMobile(e.detail.value.phone)) return app.setToast(this, {content: '请输入正确的11位手机号'})\n      this.getCode(e.detail.value.phone)\n    } else {\n      if (app.checkMobile(e.detail.value.phone)) return app.setToast(this, {content: '请输入正确的11位手机号'})\n      if (!e.detail.value.code) return app.setToast(this, {content: '请输入验证码'})\n      app.wxrequest({\n        url: app.getUrl().bind,\n        data: {\n          session3rd: app.gs(),\n          phone: e.detail.value.phone,\n          code: e.detail.value.code\n        },\n        success (res) {\n          wx.hideLoading()\n          if (res.data.code === '200') {\n            wx.showToast({\n              title: '绑定成功'\n            })\n            setTimeout(() => {\n              wx.navigateBack({\n                delta: 1\n              })\n            }, 1000)\n          } else {\n            app.setToast(that, {content: res.data.msg})\n          }\n        }\n      })\n    }\n  },\n  // 倒计时\n  lostTime () {\n    let that = this\n    let time = 60\n    // todo 请求验证码\n    let timer = setInterval(() => {\n      if (time <= 1) {\n        that.setData({\n          disabled: false,\n          text: `重发送验证码`\n        })\n        return clearInterval(timer)\n      }\n      that.setData({\n        disabled: true,\n        text: `${--time}秒后重发送`\n      })\n    }, 1000)\n  },\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad () {\n    // TODO: onLoad\n  },\n\n  /**\n   * 生命周期函数--监听页面初次渲染完成\n   */\n  onReady () {\n    // TODO: onReady\n  },\n\n  /**\n   * 生命周期函数--监听页面显示\n   */\n  onShow () {\n    // TODO: onShow\n  },\n\n  /**\n   * 生命周期函数--监听页面隐藏\n   */\n  onHide () {\n    // TODO: onHide\n  },\n\n  /**\n   * 生命周期函数--监听页面卸载\n   */\n  onUnload () {\n    // TODO: onUnload\n  },\n\n  /**\n   * 页面相关事件处理函数--监听用户下拉动作\n   */\n  onPullDownRefresh () {\n    // TODO: onPullDownRefresh\n  }\n})\n"]}