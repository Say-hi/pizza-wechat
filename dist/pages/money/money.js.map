{"version":3,"sources":["pages/money/money.js"],"names":["app","getApp","Page","data","show","listArr","page","setData","charge","e","detail","value","money","setToast","content","that","wxrequest","url","getUrl","pay","session3rd","gs","success","res","wx","hideLoading","code","timeStamp","toString","errMsg","showToast","title","setTimeout","navigateBack","delta","fail","wxpay","msg","getDetail","mymoney","v","time","Date","toLocaleString","concat","more","length","getrechargeSet","rechargeSet","chargeArr","onLoad","options","m","onReachBottom","onReady","onShow","onHide","onUnload","onPullDownRefresh"],"mappings":"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","file":"money.js","sourcesContent":["// 获取全局应用程序实例对象\nconst app = getApp()\n\n// 创建页面实例对象\nPage({\n  /**\n   * 页面的初始数据\n   */\n  data: {\n    show: false,\n    listArr: [],\n    page: -1\n  },\n  show () {\n    this.setData({\n      show: !this.data.show\n    })\n  },\n  charge (e) {\n    if (e.detail.value.money <= 0 || !e.detail.value.money) return app.setToast(this, {content: '请输入充值金额'})\n    let that = this\n    app.wxrequest({\n      url: app.getUrl().pay,\n      data: {\n        session3rd: app.gs(),\n        money: e.detail.value.money\n      },\n      success (res) {\n        wx.hideLoading()\n        if (res.data.code === '200') {\n          res.data.data.timeStamp = res.data.data.timeStamp.toString()\n          res.data.data.success = function (res) {\n            if (res.errMsg === 'requestPayment:ok') {\n              wx.showToast({\n                title: '充值成功'\n              })\n              that.setData({\n                show: false\n              })\n              setTimeout(() => {\n                wx.navigateBack({\n                  delta: 1\n                })\n              }, 1000)\n            } else {\n              app.setToast(that, {content: res.errMsg})\n            }\n          }\n          res.data.data.fail = function () {\n            wx.showToast({\n              title: '充值失败'\n            })\n          }\n          app.wxpay(res.data.data)\n        } else {\n          app.setToast(that, {content: res.data.msg})\n        }\n      }\n    })\n  },\n  getDetail () {\n    let that = this\n    app.wxrequest({\n      url: app.getUrl().mymoney,\n      data: {\n        session3rd: app.gs(),\n        page: ++that.data.page\n      },\n      success (res) {\n        wx.hideLoading()\n        if (res.data.code === '200') {\n          for (let v of res.data.data) {\n            v.time = new Date(v.time * 1000).toLocaleString()\n          }\n          that.setData({\n            listArr: that.data.listArr.concat(res.data.data),\n            more: res.data.data.length < 10 ? 0 : 1\n          })\n        } else {\n          app.setToast(that, {content: res.data.msg})\n        }\n      }\n    })\n  },\n  getrechargeSet () {\n    let that = this\n    app.wxrequest({\n      url: app.getUrl().rechargeSet,\n      data: {\n        session3rd: app.gs()\n      },\n      success (res) {\n        wx.hideLoading()\n        if (res.data.code === '200') {\n          that.setData({\n            chargeArr: res.data.data\n          })\n        } else {\n          app.setToast(that, {content: res.data.msg})\n        }\n      }\n    })\n  },\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad (options) {\n    this.setData({\n      m: options.m\n    })\n    this.getrechargeSet()\n    this.getDetail()\n    // TODO: onLoad\n  },\n  onReachBottom () {\n    if (!this.data.more) return app.setToast(this, {content: '您没有更多的交易信息啦'})\n    this.getDetail()\n  },\n  /**\n   * 生命周期函数--监听页面初次渲染完成\n   */\n  onReady () {\n    // TODO: onReady\n  },\n\n  /**\n   * 生命周期函数--监听页面显示\n   */\n  onShow () {\n    // TODO: onShow\n  },\n\n  /**\n   * 生命周期函数--监听页面隐藏\n   */\n  onHide () {\n    // TODO: onHide\n  },\n\n  /**\n   * 生命周期函数--监听页面卸载\n   */\n  onUnload () {\n    // TODO: onUnload\n  },\n\n  /**\n   * 页面相关事件处理函数--监听用户下拉动作\n   */\n  onPullDownRefresh () {\n    // TODO: onPullDownRefresh\n  }\n})\n"]}