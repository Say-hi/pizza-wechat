{"version":3,"sources":["pages/car/car.js"],"names":["app","getApp","Page","data","allMoney","chooseMenuNum","e","currentTarget","dataset","type","menuArr","index","num","setData","calculatorMoney","confirm","setToast","content","dispatch","wx","navigateTo","url","del","splice","setting","editor","su","gs","v","checked","price","toFixed","chooseAll","must","all","choose","entries","i","length","onLoad","onReady","onShow","shop","onHide","onUnload","onPullDownRefresh"],"mappings":"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","file":"car.js","sourcesContent":["// 获取全局应用程序实例对象\nconst app = getApp()\n\n// 创建页面实例对象\nPage({\n  /**\n   * 页面的初始数据\n   */\n  data: {\n    allMoney: 0\n  },\n  // 菜单页数量选择\n  chooseMenuNum (e) {\n    if (e.currentTarget.dataset.type === 'del') {\n      --this.data.menuArr[e.currentTarget.dataset.index].num\n    } else {\n      if (!this.data.menuArr[e.currentTarget.dataset.index].num) {\n        this.data.menuArr[e.currentTarget.dataset.index].num = 1\n      } else {\n        ++this.data.menuArr[e.currentTarget.dataset.index].num\n      }\n    }\n    this.setData({\n      menuArr: this.data.menuArr\n    })\n    this.calculatorMoney()\n  },\n  // 确认订单\n  confirm () {\n    if (this.data.allMoney <= 0) return app.setToast(this, {content: '请选择要购买的商品'})\n    if (this.data.allMoney < this.data.dispatch) return app.setToast(this, {content: `抱歉，起送金额为${this.data.dispatch}元哦`})\n    wx.navigateTo({\n      url: `../submitOrder/submitOrder?money=${this.data.allMoney}`\n    })\n  },\n  // 删除当前物品\n  del (e) {\n    this.data.menuArr.splice(e.currentTarget.dataset.index, 1)\n    this.setData({\n      menuArr: this.data.menuArr\n    })\n    this.calculatorMoney()\n  },\n  // 编辑\n  setting () {\n    this.setData({\n      editor: !this.data.editor\n    })\n  },\n  // 计算总价格\n  calculatorMoney () {\n    let allMoney = 0\n    app.su('goodsStorage', this.data.menuArr)\n    for (let v of app.gs('goodsStorage')) {\n      if (v.num && v.checked) {\n        allMoney += v.num * v.price\n      }\n    }\n    this.setData({\n      allMoney: allMoney.toFixed(2)\n    })\n  },\n  // 选择所有\n  chooseAll (must) {\n    if (must === 'must') {\n      // console.log(1)\n      for (let v of this.data.menuArr) {\n        v['checked'] = true\n      }\n      this.setData({\n        all: true,\n        menuArr: this.data.menuArr\n      })\n    } else {\n      // console.log(2)\n      for (let v of this.data.menuArr) {\n        v['checked'] = !this.data.all\n      }\n      this.setData({\n        all: !this.data.all,\n        menuArr: this.data.menuArr\n      })\n    }\n    this.calculatorMoney()\n  },\n  // 多项选择\n  choose (e) {\n    this.data.menuArr[e.currentTarget.dataset.index].checked = !this.data.menuArr[e.currentTarget.dataset.index].checked\n    for (let [i, v] of this.data.menuArr.entries()) {\n      if (!v.checked) {\n        this.setData({\n          all: false,\n          menuArr: this.data.menuArr\n        })\n        this.calculatorMoney()\n        return\n      }\n      if (i === this.data.menuArr.length - 1) {\n        this.setData({\n          all: true,\n          menuArr: this.data.menuArr\n        })\n      }\n    }\n    this.calculatorMoney()\n  },\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad () {\n    // TODO: onLoad\n  },\n\n  /**\n   * 生命周期函数--监听页面初次渲染完成\n   */\n  onReady () {\n    // TODO: onReady\n  },\n\n  /**\n   * 生命周期函数--监听页面显示\n   */\n  onShow () {\n    if (app.gs('goodsStorage')) {\n      // console.log(2)\n      this.setData({\n        menuArr: app.gs('goodsStorage')\n      })\n      this.chooseAll('must')\n    } else {\n      // console.log(1)\n      this.setData({\n        menuArr: []\n      })\n    }\n    this.setData({\n      dispatch: app.gs('shop').shop.dispatch\n    })\n    // TODO: onShow\n  },\n\n  /**\n   * 生命周期函数--监听页面隐藏\n   */\n  onHide () {\n    // TODO: onHide\n  },\n\n  /**\n   * 生命周期函数--监听页面卸载\n   */\n  onUnload () {\n    // TODO: onUnload\n  },\n\n  /**\n   * 页面相关事件处理函数--监听用户下拉动作\n   */\n  onPullDownRefresh () {\n    // TODO: onPullDownRefresh\n  }\n})\n"]}